"""Create total field in Results model

Revision ID: 23659a6edd21
Revises: 1665829ccdb1
Create Date: 2023-07-18 07:37:28.627375

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = "23659a6edd21"
down_revision = "1665829ccdb1"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column(
        "results",
        sa.Column(
            "total",
            sa.Float(asdecimal=True, decimal_return_scale=7),
            server_default=sa.text("0.0"),
            nullable=True,
            comment="A combination of total_correct and total_answered fields. This is the total marks before moderation and is NOT shown to the user.",
        ),
    )
    op.alter_column(
        "results",
        "total_answered",
        existing_type=sa.INTEGER(),
        comment="Number of total questions answered",
        existing_comment="Number of total answered questions",
        existing_nullable=True,
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.alter_column(
        "results",
        "total_answered",
        existing_type=sa.INTEGER(),
        comment="Number of total answered questions",
        existing_comment="Number of total questions answered",
        existing_nullable=True,
    )
    op.drop_column("results", "total")
    # ### end Alembic commands ###
